<!-- Importing base.html as template -->
{% extends 'website/base.html' %}
{% load staticfiles %}
{% load duration %}
{% load mathfilters %}
<!-- Page Title -->
{% block title %} {{project.name}} {% endblock %}
<!-- Page Stylesheets -->
{%  block css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/project.css' %}">
{%endblock%}

{% block body %}
<div class="container">
	<div class="row header">
		<div class="col-md-12">
			<div class="row">
				<div class="col-md-12">
					<span class="project-name">{{project.owner}} / {{project.name}}</span>
				</div>
			</div>	
			
			<div class="row description">
				<div class="col-md-3 text-center">
					<span class="description-item">
						<i class="fas fa-bullseye"></i>
						{{project.application_domain}}
					</span>
				</div>
				<div class="col-md-3 text-center">
					<span class="description-item">
						<i class="fas fa-code"></i>
						{{project.main_language}}
					</span>
				</div>
				<div class="col-md-3 text-center">
					<span class="description-item">
						<i class="fas fa-balance-scale"></i>
						{{project.software_license}}
					</span>
				</div>
				<div class="col-md-3 text-center">
					<span class="description-item">
						<i class="far fa-clock"></i>
						{{project.age}} year(s) of existence
					</span>
				</div>
			</div>
		</div>
	</div>
	
	<div class="row section time-series">
		<div class="col-md-12">
			<div class="section-header row">
				<div class="col-md-12">
					<span class="section-header-title">Time Series</span>
				</div>
			</div>
			<div class="row section-chart">
				<div class="col-md-12">
					<span class="section-chart-title">Newcomers:</span>
					<div name="time-series" id="{{project.id}}_newcomers"></div>
				</div>
			</div>
			<div class="row section-chart">
				<div class="col-md-12">
					<span class="section-chart-title">Forks:</span>
					<div name="time-series" id="{{project.id}}_forks"></div>
				</div>
			</div>
			<div class="row section-chart">
				<div class="col-md-12">
					<span class="section-chart-title">Pull-requests (Merged):</span>
					<div name="time-series" id="{{project.id}}_pull_requests_merged"></div>
				</div>
			</div>			
		</div>
	</div>
</div>
{% endblock %}

{% block javascript %}
<script>
	google.charts.load('current', {'packages':['annotationchart']});
	google.charts.setOnLoadCallback(drawNewcomersTimeSeries);
	
	function drawNewcomersTimeSeries(){
		var data = new google.visualization.DataTable();
		data.addColumn('datetime', 'Date');
		data.addColumn('number', 'Newcomers');
		
		var rows = []
		{% for value in newcomers_time_series %}
			rows.push([new Date("{{ value.date }}"), {{ value.count }}]);
		{% endfor %}
		rows.sort(function(a,b){return a[0].getTime() - b[0].getTime()})
		data.addRows(rows);
		
		var options = { fontName: 'Rajdhani',
		displayAnnotations: true,
		title:'Newcomers (Daily)',
		
		hAxis: {
			title: 'Number of newcomers',
		},
		vAxis: {
			title: 'Date',
			logScale: false,
		},
		height:300,
	};
	
	var {{project.id}}_newcomers = new google.visualization.AnnotationChart(document.getElementById('{{project.id}}_newcomers'));		
	{{project.id}}_newcomers.draw(data, options);
};

</script>
{% endblock %}
